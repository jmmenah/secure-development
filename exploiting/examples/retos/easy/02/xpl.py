#!/usr/bin/python3
from pwn import *
elf = context.binary = ELF("02")
HOST = "www.iesvirgendelcarmen.com"
PORT = 10002
gs = '''
b main
'''
def start():
    """
    Si ejecutamos:$ xpl.py sin parámetros io.sendXXX para enviar datos por entrada estandar al proceso. io.recXXX para leer datos salida estandar del proceso.
    Si ejecutamos:$ xpl.py GDB se abre una nueva ventana con el depurador
    Si ejecutamos:$ xpl.py REMOTE se abre un socket con servidor remoto. La entrada y salida funciona igual que en local.
    """
    global libc
    libc = elf.libc
    if args.GDB:
        return gdb.debug(elf.path, gdbscript=gs)
    if args.REMOTE:
        libc = ELF('libc6_2.23-0ubuntu11.2_i386.so')
        return remote(HOST, PORT)
    else:
        return process(elf.path)


io = start()

# Distintas versiones de libc en local y remoto. Se carga la adecuada la versión local o remota en start().
